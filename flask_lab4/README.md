# Лабораторная работа 4 - Валидаторы и HTTP-запросы

## Описание

Данная лабораторная работа направлена на изучение GET и POST запросов, создание и тестирование валидаторов форм с использованием Flask-WTF, а также работу с системными командами через веб-интерфейс.

## Задачи

### 1. Валидаторы. Добавление
В файле `registration.py` реализована форма регистрации с валидаторами для следующих полей:
- email - текст, обязательное поле, валидация формата
- phone - число, обязательное поле, проверка длины (10 цифр) и положительных значений
- name - текст, обязательное поле
- address - текст, обязательное поле
- index - число, обязательное поле
- comment - текст, необязательное поле

### 2. Валидаторы. Создание
В файле `validators.py` реализованы два типа валидаторов для проверки длины числа:
- Функциональный валидатор `number_length`
- Класс-валидатор `NumberLength`

Оба валидатора принимают параметры:
- `min` - минимальная длина числа
- `max` - максимальная длина числа
- `message` - опциональное сообщение об ошибке

### 3. Валидаторы. Тестирование
В файле `test_registration.py` реализованы юнит-тесты для проверки работы валидаторов. Тесты проверяют:
- Успешную регистрацию с валидными данными
- Обработку отсутствующих обязательных полей
- Валидацию формата email
- Валидацию длины и знака номера телефона
- Обязательность полей name и address
- Валидацию числового типа для поля index
- Опциональность поля comment
- Обработку неожиданного формата данных

### 4. Время работы системы
В файле `uptime.py` реализован GET-эндпоинт `/uptime`, который выводит строку с информацией о времени работы системы с момента последней перезагрузки.

### 5. Текущие процессы
В файле `ps.py` реализован GET-эндпоинт `/ps`, который принимает аргументы командной строки через параметр `arg` и возвращает результат выполнения команды `ps` с этими аргументами.

## Установка и запуск

### Необходимые пакеты
```bash
pip install Flask Flask-WTF email-validator
```

### Запуск сервера
Для запуска каждого из эндпоинтов используйте следующие команды:

```bash
# Задача 1-3: Форма регистрации с валидаторами
python registration.py

# Задача 4: Время работы системы
python uptime.py

# Задача 5: Текущие процессы
python ps.py
```

## Тестирование

### Ручное тестирование через Postman или curl

#### Задача 1: Регистрация
```bash
# Валидные данные
curl -X POST http://127.0.0.1:5000/registration \
  -d "email=test@example.com" \
  -d "phone=1234567890" \
  -d "name=John Doe" \
  -d "address=123 Main St" \
  -d "index=12345" \
  -d "comment=Optional comment"

# Невалидные данные
curl -X POST http://127.0.0.1:5000/registration \
  -d "email=invalid-email" \
  -d "phone=123" \
  -d "name=" \
  -d "address=" \
  -d "index=abc"
```

#### Задача 4: Uptime
```bash
curl http://127.0.0.1:5000/uptime
```

#### Задача 5: PS
```bash
# Запрос ps aux
curl http://127.0.0.1:5000/ps?arg=a&arg=u&arg=x

# Запрос ps -ef
curl http://127.0.0.1:5000/ps?arg=-e&arg=-f
```

### Запуск автоматических тестов
```bash
python test_registration.py
```

## Важно

- В задаче 1 для работы валидатора email требуется установить дополнительный пакет `email-validator`:
  ```bash
  pip install email-validator
  ```

- В задачах 4 и 5 используются системные команды, поэтому они могут работать только в Unix-подобных системах (Linux, macOS).